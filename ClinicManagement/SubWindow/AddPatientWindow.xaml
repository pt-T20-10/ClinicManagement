<Window x:Class="ClinicManagement.SubWindow.AddPatientWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
        xmlns:local="clr-namespace:ClinicManagement.SubWindow"
        xmlns:materialDesign="http://materialdesigninxaml.net/winfx/xaml/themes"
        TextElement.Foreground="{DynamicResource MaterialDesignBody}"
        TextElement.FontWeight="Regular"
        TextElement.FontSize="13"
        TextOptions.TextFormattingMode="Ideal"
        TextOptions.TextRenderingMode="Auto"
        Background="{DynamicResource MaterialDesignPaper}"
        FontFamily="{DynamicResource MaterialDesignFont}"
        mc:Ignorable="d"
        xmlns:i="http://schemas.microsoft.com/xaml/behaviors" 
        WindowStyle="None"
        ResizeMode="NoResize"
        Name="addPatientWindow"
        Title="Thêm bệnh nhân mới"
        Style="{StaticResource MaterialDesignWindow}"
        xmlns:uc="clr-namespace:ClinicManagement.UserControlToUse"
        WindowStartupLocation="CenterScreen"
        Width="600" Height="600"
       >
    <i:Interaction.Triggers>
        <i:EventTrigger EventName="Loaded">
            <i:InvokeCommandAction Command="{Binding LoadedWindowCommand}" CommandParameter="{Binding ElementName=addPatientWindow}"/>
        </i:EventTrigger>
    </i:Interaction.Triggers>
    <Grid>
        <Grid.RowDefinitions>
            <RowDefinition Height="auto"/>
            <RowDefinition Height="*"/>
            <RowDefinition Height="auto"/>
        </Grid.RowDefinitions>

        <!-- Control Bar -->
        <Grid Grid.Row="0">
            <uc:ControlBarUC Tag="{Binding Title, ElementName=addPatientWindow}"/>
        </Grid>

        <!-- Main Content -->
        <materialDesign:Card Grid.Row="1" Margin="16">
            <ScrollViewer VerticalScrollBarVisibility="Auto">
                <StackPanel Margin="16">
                    <!-- Header -->
                    <TextBlock Text="THÊM BỆNH NHÂN MỚI" 
                               FontSize="20" FontWeight="Bold" 
                               HorizontalAlignment="Center"
                               Margin="0,0,0,24"/>

                    <!-- Patient Code -->
                    <TextBox Text="{Binding PatientCode, UpdateSourceTrigger=PropertyChanged}"
                             materialDesign:HintAssist.Hint="Mã bệnh nhân"
                             Style="{StaticResource MaterialDesignOutlinedTextBox}"
                             Margin="0,8,0,16"/>

                    <!-- Full Name -->
                    <TextBox Text="{Binding FullName, UpdateSourceTrigger=PropertyChanged}"
                             materialDesign:HintAssist.Hint="Họ và tên"
                             Style="{StaticResource MaterialDesignOutlinedTextBox}"
                             Margin="0,0,0,16"/>

                    <!-- Birth Year -->
                    <Grid Margin="0,0,0,16">
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="*"/>
                            <ColumnDefinition Width="*"/>
                        </Grid.ColumnDefinitions>

                        <TextBox Grid.Column="0" 
                                 Text="{Binding BirthYear, UpdateSourceTrigger=PropertyChanged}"
                                 materialDesign:HintAssist.Hint="Năm sinh"
                                 Style="{StaticResource MaterialDesignOutlinedTextBox}"
                                 Margin="0,0,8,0"/>

                        <!-- Gender -->
                        <ComboBox Grid.Column="1"
                                  ItemsSource="{Binding GenderList}"
                                  SelectedItem="{Binding SelectedGender}"
                                  materialDesign:HintAssist.Hint="Giới tính"
                                  Style="{StaticResource MaterialDesignOutlinedComboBox}"
                                  Margin="8,0,0,0"/>
                    </Grid>

                    <!-- Phone -->
                    <TextBox Text="{Binding Phone, UpdateSourceTrigger=PropertyChanged}"
                             materialDesign:HintAssist.Hint="Số điện thoại"
                             Style="{StaticResource MaterialDesignOutlinedTextBox}"
                             Margin="0,0,0,16"/>

                    <!-- Email -->
                    <TextBox Text="{Binding Email, UpdateSourceTrigger=PropertyChanged}"
                             materialDesign:HintAssist.Hint="Email"
                             Style="{StaticResource MaterialDesignOutlinedTextBox}"
                             Margin="0,0,0,16"/>

                    <!-- Address -->
                    <TextBox Text="{Binding Address, UpdateSourceTrigger=PropertyChanged}"
                             materialDesign:HintAssist.Hint="Địa chỉ"
                             Style="{StaticResource MaterialDesignOutlinedTextBox}"
                             Margin="0,0,0,16"/>

                    <!-- Insurance Number -->
                    <TextBox Text="{Binding InsuranceNumber, UpdateSourceTrigger=PropertyChanged}"
                             materialDesign:HintAssist.Hint="Số BHYT"
                             Style="{StaticResource MaterialDesignOutlinedTextBox}"
                             Margin="0,0,0,16"/>

                    <!-- Medical History -->
                    <TextBox Text="{Binding MedicalHistory, UpdateSourceTrigger=PropertyChanged}"
                             materialDesign:HintAssist.Hint="Tiền sử bệnh"
                             TextWrapping="Wrap"
                             AcceptsReturn="True"
                             MinHeight="80"
                             Style="{StaticResource MaterialDesignOutlinedTextBox}"
                             Margin="0,0,0,16"/>

                    <!-- Allergy Information -->
                    <TextBox Text="{Binding AllergyInfo, UpdateSourceTrigger=PropertyChanged}"
                             materialDesign:HintAssist.Hint="Thông tin dị ứng"
                             Style="{StaticResource MaterialDesignOutlinedTextBox}"
                             Margin="0,0,0,16"/>

                    <!-- Notes -->
                    <TextBox Text="{Binding Notes, UpdateSourceTrigger=PropertyChanged}"
                             materialDesign:HintAssist.Hint="Ghi chú"
                             TextWrapping="Wrap"
                             AcceptsReturn="True"
                             MinHeight="60"
                             Style="{StaticResource MaterialDesignOutlinedTextBox}"
                             Margin="0,0,0,16"/>
                </StackPanel>
            </ScrollViewer>
        </materialDesign:Card>

        <!-- Action Buttons -->
        <StackPanel Grid.Row="2" 
                    Orientation="Horizontal" 
                    HorizontalAlignment="Center" 
                    Margin="16">
            <Button Command="{Binding SaveCommand}"
                    Style="{StaticResource MaterialDesignRaisedButton}"
                    Width="150" 
                    Height="45" 
                    Margin="0,0,24,0">
                <StackPanel Orientation="Horizontal">
                    <materialDesign:PackIcon Kind="ContentSave" 
                                             VerticalAlignment="Center" 
                                             Margin="0,0,8,0"/>
                    <TextBlock Text="Lưu"/>
                </StackPanel>
            </Button>

            <Button Command="{Binding CancelCommand}"
                    Style="{StaticResource MaterialDesignOutlinedButton}"
                    Width="150" 
                    Height="45">
                <StackPanel Orientation="Horizontal">
                    <materialDesign:PackIcon Kind="Close" 
                                             VerticalAlignment="Center" 
                                             Margin="0,0,8,0"/>
                    <TextBlock Text="Hủy"/>
                </StackPanel>
            </Button>
        </StackPanel>
    </Grid>
</Window>
